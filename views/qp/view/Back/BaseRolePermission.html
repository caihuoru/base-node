<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width" />
    <title>后台系统 - 管理员管理-权限配置</title>
    <link href="../../Content/Admin/css/bootstrap-cerulean.min.css" rel="stylesheet" />
    <link href="../../Content/Admin/css/charisma-app.css" rel="stylesheet" />
    <link href="../../Content/common.css" rel="stylesheet" />
    <script src="../../Scripts/jquery-1.10.2.min.js"></script>
    <script src="../../Scripts/comm.js"></script>
<style type="text/css">
    body{
        overflow-y: scroll!important;
    }
</style>
</head>
<body>
<div id="content" class="main-content">
    <div class="row">
        <div class="col-md-12">
            <div class="box-inner">
                <div class="box-header well" data-original-title="">
                    <h2><i class="glyphicon glyphicon-hand-right"></i> 你当前位置：后台系统 - 管理员管理-权限配置 </h2>
                    <div class="box-icon">
                        <a href="#" class="btn btn-round btn-default" onclick="history.go(0);">
                            <i class="glyphicon glyphicon-repeat"></i>
                        </a>
                        <a href="#" class="btn btn-minimize btn-round btn-default">
                            <i class="glyphicon glyphicon-chevron-up"></i>
                        </a>
                    </div>
                </div>
                <div class="box-content" style="overflow: hidden; display: block;">
                    <ul class="media nav nav-tabs margin-b-10">
                        <li class="active">
                            <a href="javascript:void(0);">角色管理</a>
                        </li>
                        <li>
                            <a href="BaseUserList.html">用户管理</a>
                        </li>

                    </ul>
                    <div class="panel panel-primary" style="margin-top:-11px;margin-left:-10px;">
                        <div class="panel-heading">
                            <h3 class="panel-title">【】权限信息列表</h3>
                        </div>
                        <div class="panel-body" style="margin-top:-16px;">
                        </div>
                        <div class="panel-footer">
                            <div class="row">
                                <div class="col-md-1" style="text-align:right;"></div>
                                <div class="col-md-4" style="text-align:left;">
                                    <a class="btn btn-outline-primary" href='../GuanLiYuanGuanLi.html'>
                                        <i class="glyphicon glyphicon-fast-backward icon-white"></i>返回
                                    </a>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                    <button type="button" class="btn btn-outline-success" onclick="Del()"> <i class="glyphicon glyphicon-send"></i>保存 </button>
                                </div>
                                <div class="col-md-4" style="text-align:left;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var pageObj = {};
    var postData = {};//搜索条件
    $(document).ready(function () {
        docReady();
    });
    function docReady() {
        //收放事件
        $('.btn-minimize').click(function (e) {
            e.preventDefault();
            var $target = $(this).parent().parent().next('.box-content');
            if ($target.is(':visible')) $('i', $(this)).removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');
            else $('i', $(this)).removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');
            $target.slideToggle();
        });
    }
    function Del(id) {
        var array = [];
        $('input[name="all"]').each(function () {
            $(this).parent().parent().parent().next(".item").each(function () {
                //二级循环
                $(this).find(".row").each(function () {
                    var data = {};
                    data.RoleID = parseInt('0');
                    data.OperationPermission = 0;
                    $(this).find("input[type='checkbox']:checked").each(function () {
                        data.ModuleID = parseInt($(this).attr("mid"));
                        data.OperationPermission = data.OperationPermission | parseInt($(this).val());
                    });
                    if (typeof (data.ModuleID) != "undefined") {
                        array.push(data);
                    }
                });
            });
        });
        var postdata = {};
        postdata.RoleID = parseInt('0');
        postdata.list = JSON.stringify(array);
        AjaxSubmit("/Back/DoBaseRolePermission", postdata, callBack, "del");
    }
    //回调函数
    function callBack(jsonData, fname) {
        switch (fname) {
            case "del":
                alert(jsonData.Msg);
                window.location.href = "/Back/Index";
                break;
        }
    }
</script>

</body>
</html>
